<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>InCheck Pro Dashboard ‚Äî Issues ¬∑ Ops ¬∑ AI Copilot</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Styles -->
    <link rel="stylesheet" href="styles.css" />

    <!-- FullCalendar styles (optional, adjust version/CDN as you prefer) -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/main.min.css"
    />
  </head>
  <body>
    <!-- Spinner overlay -->
    <div id="spinner" class="spinner" aria-hidden="true">
      <div class="ring" aria-label="Loading"></div>
    </div>

    <!-- Toast -->
    <div id="toast" class="toast" role="status" aria-live="polite"></div>

    <!-- Header -->
    <header>
      <div class="brand">
        <div class="logo">IC</div>
        <div class="brand-text">
          <span>InCheck Pro</span>
          <span>Issues ¬∑ Ops ¬∑ Releases</span>
        </div>
      </div>

      <!-- Drawer toggle (mobile) -->
      <button
        id="drawerBtn"
        class="btn sm drawer-toggle"
        type="button"
        aria-expanded="false"
        aria-controls="sidebar"
      >
        <span class="icon">‚ò∞</span>
        Filters
      </button>

      <!-- Toolbar -->
      <div class="toolbar">
        <input
          id="searchInput"
          class="input"
          type="search"
          placeholder="Search issues (/)"
          aria-label="Search issues"
        />

        <select id="themeSelect" class="select" aria-label="Theme">
          <option value="system">System</option>
          <option value="dark">Dark</option>
          <option value="light">Light</option>
        </select>

        <input
          id="accentColor"
          type="color"
          aria-label="Accent color"
          title="Accent color"
        />

        <button id="refreshNow" class="btn sm" type="button">
          <span class="icon">‚ü≥</span>
          Sync
        </button>

        <button id="exportCsv" class="btn sm" type="button">
          ‚¨á CSV
        </button>

        <button id="createTicketBtn" class="btn sm primary" type="button">
          Ôºã New Ticket
        </button>

        <button
          id="shortcutsHelp"
          class="btn sm ghost"
          type="button"
          title="Keyboard shortcuts"
        >
          ?
        </button>

        <div class="statusline">
          <span id="onlineStatusChip" class="chip online">Online</span>

          <span class="chip">
            <span id="syncIssuesDot" class="dot ok"></span>
            <span id="syncIssuesText">Issues: ‚Äî</span>
          </span>

          <span class="chip">
            <span id="syncEventsDot" class="dot ok"></span>
            <span id="syncEventsText">Events: ‚Äî</span>
          </span>

          <span id="loadingStatus" class="shortcut-chip"></span>
        </div>
      </div>
    </header>

    <!-- Main layout -->
    <main class="wrap">
      <!-- Sidebar -->
      <aside id="sidebar" class="sidebar">
        <h3>Filters</h3>

        <div class="filter-group">
          <div class="filter-row">
            <label for="moduleFilter" class="muted">Module</label>
            <select id="moduleFilter" class="select">
              <!-- options filled by JS -->
            </select>
          </div>

          <div class="filter-row">
            <label for="priorityFilter" class="muted">Priority</label>
            <select id="priorityFilter" class="select">
              <!-- options filled by JS -->
            </select>
          </div>

          <div class="filter-row">
            <label for="statusFilter" class="muted">Status</label>
            <select id="statusFilter" class="select">
              <!-- options filled by JS -->
            </select>
          </div>

          <div class="filter-row">
            <label class="muted" for="startDateFilter">From</label>
            <input
              id="startDateFilter"
              class="input"
              type="date"
              aria-label="Start date"
            />
          </div>
          <div class="filter-row">
            <label class="muted" for="endDateFilter">To</label>
            <input
              id="endDateFilter"
              class="input"
              type="date"
              aria-label="End date"
            />
          </div>

          <button id="resetBtn" class="btn sm" type="button">
            Reset filters
          </button>
        </div>

        <div class="divider"></div>

        <h3>Calendar Filters</h3>
        <div class="filter-group">
          <label class="muted">Event types</label>
          <label class="muted">
            <input
              type="checkbox"
              id="eventFilterDeployment"
              checked
            />
            Deployment
          </label>
          <label class="muted">
            <input
              type="checkbox"
              id="eventFilterMaintenance"
              checked
            />
            Maintenance
          </label>
          <label class="muted">
            <input type="checkbox" id="eventFilterRelease" checked />
            Release
          </label>
          <label class="muted">
            <input type="checkbox" id="eventFilterOther" checked />
            Other
          </label>
        </div>

        <div class="divider"></div>

        <!-- Release Planner card -->
        <div id="releasePlannerCard" class="card">
          <div class="summary-bar">
            <div>
              <div class="label">Release Planner</div>
              <div class="shortcut-chip">
                F&amp;B ¬∑ Middle East change windows
              </div>
            </div>
          </div>

          <div class="planner-grid" style="margin-top:8px;">
            <div>
              <label for="plannerRegion">Region</label>
              <select id="plannerRegion" class="select">
                <option value="gulf">Gulf (KSA / UAE / Qatar)</option>
                <option value="levant">Levant</option>
                <option value="northafrica">North Africa</option>
              </select>
            </div>

            <div>
              <label for="plannerEnv">Environment</label>
              <select id="plannerEnv" class="select">
                <option value="Prod">Prod</option>
                <option value="Staging">Staging</option>
                <option value="Dev">Dev</option>
                <option value="Other">Other</option>
              </select>
            </div>

            <div>
              <label for="plannerHorizon">Horizon (days)</label>
              <input
                id="plannerHorizon"
                class="input"
                type="number"
                min="1"
                max="30"
                value="7"
              />
            </div>

            <div>
              <label for="plannerModules">Modules</label>
              <input
                id="plannerModules"
                class="input"
                type="text"
                placeholder="e.g. POS, Checkout"
              />
            </div>

            <div>
              <label for="plannerReleaseType">Release type</label>
              <select id="plannerReleaseType" class="select">
                <option value="feature">Feature</option>
                <option value="minor">Minor Fix</option>
                <option value="major">Major</option>
              </select>
            </div>

            <div>
              <label for="plannerSlotsPerDay">Slots / day</label>
              <input
                id="plannerSlotsPerDay"
                class="input"
                type="number"
                min="1"
                max="10"
                value="4"
              />
            </div>
          </div>

          <div style="margin-top:8px;">
            <label for="plannerDescription">Release description</label>
            <textarea
              id="plannerDescription"
              class="input"
              placeholder="Brief description / blast radius‚Ä¶"
            ></textarea>
          </div>

          <div style="margin-top:8px;">
            <label for="plannerTickets">Tickets in scope</label>
            <select
              id="plannerTickets"
              class="select"
              multiple
              size="4"
            >
              <!-- filled by JS -->
            </select>
          </div>

          <div style="margin-top:8px;display:flex;gap:6px;flex-wrap:wrap;">
            <button
              id="plannerRun"
              class="btn sm primary"
              type="button"
            >
              Run planner
            </button>
            <button
              id="plannerAddEvent"
              class="btn sm"
              type="button"
              disabled
            >
              Add top slot as Release
            </button>
          </div>

          <div
            id="plannerResults"
            class="muted"
            style="margin-top:8px;font-size:12px;"
          >
            No plan yet. Select tickets and click ‚ÄúRun planner‚Äù.
          </div>

          <div style="margin-top:8px;">
            <label for="plannerReleasePlan">Existing Release events</label>
            <select id="plannerReleasePlan" class="select">
              <option value="">No Release events in horizon</option>
            </select>
          </div>

          <div style="margin-top:6px;">
            <button
              id="plannerAssignBtn"
              class="btn sm"
              type="button"
            >
              Assign selected tickets to Release
            </button>
          </div>
        </div>
      </aside>

      <!-- Main content -->
      <section class="content">
        <!-- Tabs: only Issues + Calendar now -->
        <div class="view-tabs" role="tablist">
          <button
            id="issuesTab"
            class="view-tab active"
            type="button"
            role="tab"
            aria-selected="true"
            data-view="issues"
          >
            <span class="icon">üìã</span>
            <span>Issues</span>
          </button>
          <button
            id="calendarTab"
            class="view-tab"
            type="button"
            role="tab"
            aria-selected="false"
            data-view="calendar"
          >
            <span class="icon">üìÜ</span>
            <span>Calendar</span>
          </button>
        </div>

        <!-- Issues view -->
        <section
          id="issuesView"
          class="view active"
          role="tabpanel"
          aria-labelledby="issuesTab"
        >
          <!-- Summary card -->
          <div class="card summary-bar">
            <div>
              <div id="issuesSummaryText">
                Loading issues‚Ä¶
              </div>
              <div class="shortcut-chip">
                Trends update automatically as you change filters.
              </div>
            </div>
          </div>

          <!-- Active filters chips -->
          <div class="card">
            <div class="filter-chips" id="activeFiltersChips">
              <!-- chips inserted by JS -->
            </div>
          </div>

          <!-- KPI cards -->
          <div id="kpis" class="grid cols-4">
            <!-- KPI cards inserted by JS -->
          </div>

          <!-- Charts -->
          <div class="charts">
            <div class="card">
              <div class="label">By Module</div>
              <div style="height:220px;margin-top:8px;">
                <canvas id="byModule"></canvas>
              </div>
            </div>
            <div class="card">
              <div class="label">By Priority</div>
              <div style="height:220px;margin-top:8px;">
                <canvas id="byPriority"></canvas>
              </div>
            </div>
            <div class="card">
              <div class="label">By Status</div>
              <div style="height:220px;margin-top:8px;">
                <canvas id="byStatus"></canvas>
              </div>
            </div>
            <div class="card">
              <div class="label">By Type</div>
              <div style="height:220px;margin-top:8px;">
                <canvas id="byType"></canvas>
              </div>
            </div>
          </div>

          <!-- Issues table -->
          <div class="card">
            <div class="table-wrap">
              <table id="issuesTable">
                <thead>
                  <tr>
                    <th
                      class="sortable"
                      data-key="id"
                      scope="col"
                    >
                      ID
                    </th>
                    <th
                      class="sortable"
                      data-key="module"
                      scope="col"
                    >
                      Module
                    </th>
                    <th
                      class="sortable"
                      data-key="title"
                      scope="col"
                    >
                      Title
                    </th>
                    <th
                      class="sortable"
                      data-key="priority"
                      scope="col"
                    >
                      Priority
                    </th>
                    <th
                      class="sortable"
                      data-key="status"
                      scope="col"
                    >
                      Status
                    </th>
                    <th
                      class="sortable"
                      data-key="date"
                      scope="col"
                    >
                      Date
                    </th>
                    <th scope="col">Log</th>
                    <th scope="col">Link</th>
                  </tr>
                </thead>
                <tbody id="tbodySkeleton">
                  <!-- simple loading skeleton rows -->
                  <tr>
                    <td colspan="8">
                      <div class="skeleton" style="height:28px;"></div>
                    </td>
                  </tr>
                  <tr>
                    <td colspan="8">
                      <div class="skeleton" style="height:28px;"></div>
                    </td>
                  </tr>
                  <tr>
                    <td colspan="8">
                      <div class="skeleton" style="height:28px;"></div>
                    </td>
                  </tr>
                </tbody>
                <tbody id="issuesTbody">
                  <!-- rows inserted by JS -->
                </tbody>
              </table>
            </div>

            <!-- Table actions / pagination -->
            <div class="table-actions">
              <span id="rowCount" class="muted">No rows</span>

              <div class="pagination">
                <button
                  id="firstPage"
                  class="chip-btn"
                  type="button"
                >
                  ¬´ First
                </button>
                <button
                  id="prevPage"
                  class="chip-btn"
                  type="button"
                >
                  ‚Äπ Prev
                </button>
                <span id="pageInfo" class="muted">Page 1 / 1</span>
                <button
                  id="nextPage"
                  class="chip-btn"
                  type="button"
                >
                  Next ‚Ä∫
                </button>
                <button
                  id="lastPage"
                  class="chip-btn"
                  type="button"
                >
                  Last ¬ª
                </button>
              </div>

              <div>
                <label for="pageSize" class="muted">Rows / page</label>
                <select
                  id="pageSize"
                  class="select sm"
                  aria-label="Rows per page"
                >
                  <option value="10">10</option>
                  <option value="20">20</option>
                  <option value="50">50</option>
                  <option value="100">100</option>
                </select>
              </div>
            </div>
          </div>
        </section>

        <!-- Calendar view -->
        <section
          id="calendarView"
          class="view"
          role="tabpanel"
          aria-labelledby="calendarTab"
        >
          <div class="card">
            <div class="summary-bar">
              <div>
                <div class="label">Change Calendar</div>
                <div class="shortcut-chip">
                  Plan deployments, maintenance and releases.
                </div>
              </div>
              <div style="display:flex;gap:8px;align-items:center;">
                <span id="calendarTz" class="muted"></span>
                <button
                  id="addEventBtn"
                  type="button"
                  class="btn sm primary"
                >
                  Ôºã Add event
                </button>
              </div>
            </div>
            <div id="calendar" aria-label="Change calendar"></div>
          </div>
        </section>
      </section>
    </main>

    <!-- Issue modal -->
    <div
      id="issueModal"
      class="modal"
      role="dialog"
      aria-modal="true"
      aria-labelledby="modalTitle"
      style="display:none;"
    >
      <div class="modal-content">
        <div class="header">
          <h2 id="modalTitle">Issue</h2>
          <button
            id="modalClose"
            class="modal-close"
            type="button"
            aria-label="Close"
          >
            √ó
          </button>
        </div>
        <div id="modalBody" class="muted">
          <!-- filled by JS -->
        </div>
        <div class="actions" style="margin-top:10px;">
          <button
            id="copyId"
            class="btn sm"
            type="button"
          >
            Copy ID
          </button>
          <button
            id="copyLink"
            class="btn sm"
            type="button"
          >
            Copy link
          </button>
        </div>
      </div>
    </div>

    <!-- Event modal -->
    <div
      id="eventModal"
      class="modal"
      role="dialog"
      aria-modal="true"
      aria-labelledby="eventModalTitle"
      style="display:none;"
    >
      <div class="modal-content">
        <div class="header">
          <h2 id="eventModalTitle">Event</h2>
          <button
            id="eventModalClose"
            class="modal-close"
            type="button"
            aria-label="Close"
          >
            √ó
          </button>
        </div>

        <form id="eventForm">
          <div class="filter-group">
            <div class="filter-row">
              <label class="muted" for="eventTitle">Title</label>
              <input
                id="eventTitle"
                class="input"
                type="text"
                required
              />
            </div>

            <div class="filter-row">
              <label class="muted" for="eventType">Type</label>
              <select id="eventType" class="select">
                <option value="Deployment">Deployment</option>
                <option value="Maintenance">Maintenance</option>
                <option value="Release">Release</option>
                <option value="Other">Other</option>
              </select>
            </div>

            <div class="filter-row">
              <label class="muted" for="eventEnv">Environment</label>
              <select id="eventEnv" class="select">
                <option value="Prod">Prod</option>
                <option value="Staging">Staging</option>
                <option value="Dev">Dev</option>
                <option value="Other">Other</option>
              </select>
            </div>

            <div class="filter-row">
              <label class="muted" for="eventStatus">Change status</label>
              <select id="eventStatus" class="select">
                <option value="Planned">Planned</option>
                <option value="In progress">In progress</option>
                <option value="Completed">Completed</option>
                <option value="Cancelled">Cancelled</option>
              </select>
            </div>

            <div class="filter-row">
              <label class="muted" for="eventOwner">Owner</label>
              <input
                id="eventOwner"
                class="input"
                type="text"
              />
            </div>

            <div class="filter-row">
              <label class="muted" for="eventModules">Modules</label>
              <input
                id="eventModules"
                class="input"
                type="text"
                placeholder="comma-separated"
              />
            </div>

            <div class="filter-row">
              <label class="muted" for="eventImpactType"
                >Impact</label
              >
              <select id="eventImpactType" class="select">
                <option value="No downtime expected">
                  No downtime expected
                </option>
                <option value="Minor impact">Minor impact</option>
                <option value="Major impact">Major impact</option>
                <option value="Full outage">Full outage</option>
              </select>
            </div>

            <div class="filter-row">
              <label class="muted" for="eventIssueId"
                >Linked ticket IDs</label
              >
              <input
                id="eventIssueId"
                class="input"
                type="text"
                placeholder="ID1, ID2‚Ä¶"
              />
            </div>

            <div class="filter-row">
              <label class="muted">All-day event</label>
              <label class="muted">
                <input
                  id="eventAllDay"
                  type="checkbox"
                />
                All day
              </label>
            </div>

            <div class="filter-row">
              <label class="muted" for="eventStart"
                >Start</label
              >
              <input
                id="eventStart"
                class="input"
                type="datetime-local"
              />
            </div>

            <div class="filter-row">
              <label class="muted" for="eventEnd">End</label>
              <input
                id="eventEnd"
                class="input"
                type="datetime-local"
              />
            </div>

            <div class="filter-row">
              <label class="muted" for="eventDescription"
                >Description</label
              >
              <textarea
                id="eventDescription"
                class="input"
              ></textarea>
            </div>

            <div
              id="eventIssueLinkedInfo"
              class="muted"
              style="margin-top:4px;display:none;"
            >
              <!-- linked issues summary -->
            </div>
          </div>

          <div class="actions" style="margin-top:10px;">
            <button
              id="eventSave"
              class="btn primary sm"
              type="submit"
            >
              Save
            </button>
            <button
              id="eventCancel"
              class="btn sm ghost"
              type="button"
            >
              Cancel
            </button>
            <button
              id="eventDelete"
              class="btn sm"
              type="button"
              style="margin-left:auto;display:none;"
            >
              Delete
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Scripts: adjust versions/CDNs as you wish -->
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.10/index.global.min.js"></script>
    <script src="app.js"></script>
  </body>
</html>
