diff --git a/index.html b/index.html
index 8e5d3deb3a944bc143dab6dcfdfc05d217f0eaac..041e7a98543e9a73496cd5286e5f11640ad6524f 100644
--- a/index.html
+++ b/index.html
@@ -107,145 +107,189 @@
 
     (cd "$(git rev-parse --show-toplevel)" && git apply --3way <<'EOF' 
diff --git a/index.html b/index.html
index 8e5d3deb3a944bc143dab6dcfdfc05d217f0eaac..041e7a98543e9a73496cd5286e5f11640ad6524f 100644
--- a/index.html
+++ b/index.html
@@ -107,145 +107,189 @@
 
     <!-- Holiday Manager -->
     <div class="card"><div class="card-body">
       <h5><i class="fas fa-calendar-day"></i> Holiday Manager</h5>
       <div class="row g-3 mb-3">
         <div class="col-md-5"><input type="date" id="holidayDate" class="form-control"/></div>
         <div class="col-md-5"><input type="text" id="holidayName" class="form-control" placeholder="Holiday Name"/></div>
         <div class="col-md-2"><button class="btn btn-primary w-100" onclick="addHoliday()"><i class="fas fa-plus"></i> Add</button></div>
       </div>
       <ul id="holidayList" class="list-group"></ul>
     </div></div>
   </div>
 
   <!-- JS LIBS -->
   <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
   <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
   <script src="https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js"></script>
     <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
   <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js"></script>
   <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js"></script>
   <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
 
   <script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzpTXfKm6S0b-syTyAQCs5VvvBzV0Za2zkNafTquI6PK2_oNXPjY-x38vwQ09Dt-Vur0A/exec";
+   // Optional fallback to work around CORS errors when the Apps Script endpoint
+   // does not expose the required headers. Set to "" to disable proxying.
+   const CORS_PROXY = "https://corsproxy.io/?";
 
     let attendanceData = [];
     let holidaysData = [];
     let leavesData = [];
 
       let barChartInstance;
     let pieChartInstance;
     let lineChartInstance;
     
     // Wrapper for fetch JSON
-    async function fetchJSON(url, options={}) {
-      const res = await fetch(url, options);
-      const text = await res.text();
-      try { return JSON.parse(text); }
-      catch(e) { console.error("Invalid JSON", text); return {}; }
+    async function fetchJSON(url, options={}, attempt=0) {
+      const target = attempt === 0 || !CORS_PROXY ? url : `${CORS_PROXY}${url}`;
+      try {
+        const res = await fetch(target, options);
+        if (!res.ok) {
+          const body = await res.text().catch(() => "");
+          throw new Error(`Request failed (${res.status} ${res.statusText}) ${body}`.trim());
+        }
+        const text = await res.text();
+        try { return JSON.parse(text); }
+        catch(e) {
+          console.error("Invalid JSON", text);
+          throw new Error("Invalid JSON response");
+        }
+      } catch (err) {
+        if (attempt === 0 && CORS_PROXY) {
+          console.warn("Falling back to CORS proxy", err);
+          return fetchJSON(url, options, attempt + 1);
+        }
+        console.error("fetchJSON error", err);
+        throw err;
+      }
+    }
+
+    const STATUS_BADGES = {
+      "on time": { cls: "badge bg-success", label: "On Time" },
+      "on time + overtime": { cls: "badge bg-success", label: "On Time + OT" },
+      "late": { cls: "badge bg-warning text-dark", label: "Late" },
+      "left early": { cls: "badge bg-info text-dark", label: "Left Early" },
+      "late & left early": { cls: "badge bg-warning text-dark", label: "Late & Left Early" },
+      "half day": { cls: "badge bg-secondary", label: "Half Day" },
+      "no sign-out": { cls: "badge bg-dark", label: "No Sign-Out" },
+      "no sign-in": { cls: "badge bg-dark", label: "No Sign-In" },
+      "holiday": { cls: "badge bg-primary", label: "Holiday" },
+      "weekend": { cls: "badge bg-secondary", label: "Weekend" },
+      "absent": { cls: "badge bg-danger", label: "Absent" },
+      "leave (sick)": { cls: "badge bg-info text-dark", label: "Leave (Sick)" },
+      "leave (annual)": { cls: "badge bg-primary", label: "Leave (Annual)" },
+      "leave (unpaid)": { cls: "badge bg-danger", label: "Leave (Unpaid)" },
+      "leave (other)": { cls: "badge bg-secondary", label: "Leave (Other)" }
+    };
+
+    function renderStatusBadge(rawStatus="") {
+      const normalized = rawStatus.trim().toLowerCase();
+      const entry = STATUS_BADGES[normalized];
+      if (entry) return `<span class="${entry.cls}">${entry.label}</span>`;
+      if (!rawStatus) return "";
+      return `<span class="badge bg-secondary">${rawStatus}</span>`;
     }
 
     // Toast helper
     function showToast(msg, type="info") {
       const id = "toast" + Date.now();
       const toast = `<div id="${id}" class="toast align-items-center text-bg-${type} p-2 fade show">
         <div class="d-flex"><div class="toast-body">${msg}</div>
         <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button></div></div>`;
       document.getElementById("toastContainer").insertAdjacentHTML("beforeend", toast);
       setTimeout(()=>document.getElementById(id)?.remove(), 4000);
     }
 
     // Dark mode
     function toggleDark() {
       document.body.classList.toggle("dark-mode");
       document.getElementById("themeIcon").classList.toggle("fa-sun");
       document.getElementById("themeIcon").classList.toggle("fa-moon");
     }
 
     // Sync server
     function syncWithServer() {
       document.getElementById("loadingOverlay").style.display="flex";
       fetchJSON(SCRIPT_URL + "?action=updateSummary")
         .then(()=>{ showToast("Attendance synced!","success"); loadAll(); })
-        .catch(()=>showToast("Sync failed","danger"))
+        .catch(err=>{ console.error(err); showToast("Sync failed","danger"); })
         .finally(()=>document.getElementById("loadingOverlay").style.display="none");
     }
 
     function downloadFullReport() {
-     if (!$.fn.DataTable.isDataTable('#attendanceTable')) {
+      if (!$.fn.DataTable.isDataTable('#attendanceTable')) {
         showToast("Please wait for the data to finish loading.", "warning");
         return;
       }
-      }
+      $('#attendanceTable').DataTable().button('.buttons-excel').trigger();
+    }
 
     // Attendance
     function loadAttendance() {
       return fetchJSON(SCRIPT_URL + "?action=getAttendance")
-        .then(data=>{
+        .then(raw=>{
+          const rows = Array.isArray(raw) ? raw : (raw && Array.isArray(raw.data) ? raw.data : []);
+          const data = rows.map(normalizeAttendanceRecord);
           attendanceData = data;
           populateEmployeeFilter(data);
           renderAttendanceTable(data);
           renderCharts(data);
-        }).catch(()=>showToast("Failed to load attendance","danger"));
+        }).catch(err=>{
+          showToast("Failed to load attendance","danger");
+          console.error(err);
+        });
+    }
+
+    function normalizeAttendanceRecord(row={}){
+      const firstIn = row.FirstIn ?? row["First In"] ?? row.SignIn ?? "";
+      const lastOut = row.LastOut ?? row["Last Out"] ?? row.SignOut ?? "";
+      return {
+        Name: row.Name ?? row.Employee ?? "",
+        Date: row.Date ?? row.Day ?? "",
+        FirstIn: firstIn,
+        LastOut: lastOut,
+        Hours: row.Hours ?? row.TotalHours ?? row["Total Hours"] ?? "",
+        Status: row.Status ?? row.Attendance ?? ""
+      };
     }
 
     function renderAttendanceTable(data){
       if ($.fn.DataTable.isDataTable('#attendanceTable')) {
         $('#attendanceTable').DataTable().clear().rows.add(data).draw();
       } else {
         $('#attendanceTable').DataTable({
           data:data,
           columns:[
             {title:"Name", data:"Name"},
             {title:"Date", data:"Date"},
-            {title:"SignIn", data:"SignIn"},
-            {title:"SignOut", data:"SignOut"},
+            {title:"First In", data:"FirstIn"},
+            {title:"Last Out", data:"LastOut"},
             {title:"Hours", data:"Hours"},
-            {
-              title:"Status",
-              data:"Status",
-              render:function(data){
-                if(!data) return "";
-                let cls="";
-                let text=data;
-                switch(data.toLowerCase()){
-                  case "present": cls="badge bg-success"; break;
-                  case "late": cls="badge bg-warning text-dark"; break;
-                  case "early leave": cls="badge bg-info"; break;
-                  case "absent": cls="badge bg-danger"; break;
-                  case "holiday": cls="badge bg-primary"; break;
-                  case "al": cls="badge bg-primary"; text="Annual Leave"; break;
-                  case "sl": cls="badge bg-info text-dark"; text="Sick Leave"; break;
-                  case "ul": cls="badge bg-danger"; text="Unpaid Leave"; break;
-                  case "other": cls="badge bg-secondary"; text="Other Leave"; break;
-                  default: cls="badge bg-secondary"; break;
-                }
-                return `<span class="${cls}">${text}</span>`;
-              }
-            }
+            { title:"Status", data:"Status", render:renderStatusBadge }
           ],
           dom:'Bfrtip', buttons:['copy','csv','excel','print']
         });
       }
     }
 
     // Charts
     function renderCharts(data){
       const dates=data.map(r=>r.Date);
       const hours=data.map(r=>parseFloat(r.Hours||0));
       const byEmp={}; data.forEach(r=>{byEmp[r.Name]=(byEmp[r.Name]||0)+parseFloat(r.Hours||0);});
       
           const barCanvas=document.getElementById("barChart");
       const pieCanvas=document.getElementById("pieChart");
       const lineCanvas=document.getElementById("lineChart");
 
       Chart.getChart(barCanvas)?.destroy();
       Chart.getChart(pieCanvas)?.destroy();
       Chart.getChart(lineCanvas)?.destroy();
 
       barChartInstance = new Chart(barCanvas,{type:'bar',data:{labels:dates,datasets:[{label:"Hours",data:hours,backgroundColor:"#4e73df"}]}});
       pieChartInstance = new Chart(pieCanvas,{type:'pie',data:{labels:Object.keys(byEmp),datasets:[{data:Object.values(byEmp),backgroundColor:["#4e73df","#1cc88a","#e74a3b","#f6c23e","#36b9cc"]}] }});
       lineChartInstance = new Chart(lineCanvas,{type:'line',data:{labels:dates,datasets:[{label:"Trend",data:hours,borderColor:"#1cc88a",fill:false}] }});
     }
 
diff --git a/index.html b/index.html
index 8e5d3deb3a944bc143dab6dcfdfc05d217f0eaac..041e7a98543e9a73496cd5286e5f11640ad6524f 100644
--- a/index.html
+++ b/index.html
@@ -280,87 +324,105 @@
       let totalHours = filtered.reduce((sum,r)=>sum+(parseFloat(r.Hours)||0),0);
       let holCount = holidaysData.filter(h=>{
         let d=new Date(h.Date);
         return (!from||d>=from)&&(!to||d<=to);
       }).length;
       let leaveFiltered = leavesData.filter(l=>{
         if(emp && l.Employee!==emp) return false;
         let d=new Date(l.Date);
         return (!from||d>=from)&&(!to||d<=to);
       });
       let totalLeaves = leaveFiltered.length;
       let annual = leaveFiltered.filter(l=>l.Type==="Annual").length;
       let sick = leaveFiltered.filter(l=>l.Type==="Sick").length;
       let unpaid = leaveFiltered.filter(l=>l.Type==="Unpaid").length;
 
       document.getElementById("cardHours").textContent=totalHours.toFixed(2);
       document.getElementById("cardHolidays").textContent=holCount;
       document.getElementById("cardLeaves").textContent=totalLeaves;
       document.getElementById("cardAnnual").textContent=annual;
       document.getElementById("cardSick").textContent=sick;
       document.getElementById("cardUnpaid").textContent=unpaid;
     }
 
     // Holidays
     function loadHolidays(){
-      return fetchJSON(SCRIPT_URL+"?action=getHolidays").then(d=>{holidaysData=d; renderHolidays(d);});
+      return fetchJSON(SCRIPT_URL+"?action=getHolidays").then(raw=>{
+        const data = Array.isArray(raw) ? raw : (raw && Array.isArray(raw.data) ? raw.data : []);
+        holidaysData=data;
+        renderHolidays(data);
+      }).catch(err=>{
+        console.error(err);
+        showToast("Failed to load holidays","danger");
+      });
     }
     function renderHolidays(data){
       const list=document.getElementById("holidayList"); list.innerHTML="";
       data.forEach(row=>{
         const li=document.createElement("li");
         li.className="list-group-item d-flex justify-content-between align-items-center";
         li.textContent=row.Date+" - "+row.Name;
         const btn=document.createElement("button");
         btn.className="btn btn-sm btn-danger"; btn.innerHTML="<i class='fas fa-trash'></i>";
         btn.onclick=()=>removeHoliday(row.Date);
         li.appendChild(btn); list.appendChild(li);
       });
     }
     function addHoliday(){
       const date=document.getElementById("holidayDate").value;
       const name=document.getElementById("holidayName").value;
       if(!date||!name) return showToast("Date & Name required","danger");
       fetchJSON(SCRIPT_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"addHoliday",date,name})})
-        .then(()=>{showToast("Holiday added","success");loadHolidays();});
+        .then(()=>{showToast("Holiday added","success");loadHolidays();})
+        .catch(err=>{console.error(err);showToast("Failed to add holiday","danger");});
     }
     function removeHoliday(date){
       fetchJSON(SCRIPT_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"removeHoliday",date})})
-        .then(()=>{showToast("Holiday removed","success");loadHolidays();});
+        .then(()=>{showToast("Holiday removed","success");loadHolidays();})
+        .catch(err=>{console.error(err);showToast("Failed to remove holiday","danger");});
     }
 
     // Leaves
     function loadLeaves(){
-      return fetchJSON(SCRIPT_URL+"?action=getLeaves").then(d=>{leavesData=d; renderLeaves(d);});
+      return fetchJSON(SCRIPT_URL+"?action=getLeaves").then(raw=>{
+        const data = Array.isArray(raw) ? raw : (raw && Array.isArray(raw.data) ? raw.data : []);
+        leavesData=data;
+        renderLeaves(data);
+      }).catch(err=>{
+        console.error(err);
+        showToast("Failed to load leaves","danger");
+      });
     }
     function renderLeaves(data){
       const list=document.getElementById("leaveList"); list.innerHTML="";
       data.forEach(row=>{
         const li=document.createElement("li");
         li.className="list-group-item d-flex justify-content-between align-items-center";
         li.textContent=row.Date+" - "+row.Employee+" ("+row.Type+") "+row.Reason;
         const btn=document.createElement("button");
         btn.className="btn btn-sm btn-danger"; btn.innerHTML="<i class='fas fa-trash'></i>";
         btn.onclick=()=>removeLeave(row.Date,row.Employee);
         li.appendChild(btn); list.appendChild(li);
       });
     }
     function addLeave(){
       const date=document.getElementById("leaveDate").value;
       const employee=document.getElementById("leaveEmployee").value;
       const type=document.getElementById("leaveType").value;
       const reason=document.getElementById("leaveReason").value;
       if(!date||!employee) return showToast("Date & Employee required","danger");
       fetchJSON(SCRIPT_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"addLeave",date,employee,type,reason})})
-        .then(()=>{showToast("Leave added","success");loadLeaves();});
+        .then(()=>{showToast("Leave added","success");loadLeaves();})
+        .catch(err=>{console.error(err);showToast("Failed to add leave","danger");});
     }
     function removeLeave(date,employee){
       fetchJSON(SCRIPT_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"removeLeave",date,employee})})
-        .then(()=>{showToast("Leave removed","success");loadLeaves();});
+        .then(()=>{showToast("Leave removed","success");loadLeaves();})
+        .catch(err=>{console.error(err);showToast("Failed to remove leave","danger");});
     }
 
     // Init
     function loadAll(){ Promise.all([loadAttendance(),loadHolidays(),loadLeaves()]).then(()=>applyFilters()); }
     loadAll();
   </script>
 </body>
 </html>
 
EOF
)
     // Leaves
     function loadLeaves(){
-      return fetchJSON(SCRIPT_URL+"?action=getLeaves").then(d=>{leavesData=d; renderLeaves(d);});
+      return fetchJSON(SCRIPT_URL+"?action=getLeaves").then(raw=>{
+        const data = Array.isArray(raw) ? raw : (raw && Array.isArray(raw.data) ? raw.data : []);
+        leavesData=data;
+        renderLeaves(data);
+      }).catch(err=>{
+        console.error(err);
+        showToast("Failed to load leaves","danger");
+      });
     }
     function renderLeaves(data){
       const list=document.getElementById("leaveList"); list.innerHTML="";
       data.forEach(row=>{
         const li=document.createElement("li");
         li.className="list-group-item d-flex justify-content-between align-items-center";
         li.textContent=row.Date+" - "+row.Employee+" ("+row.Type+") "+row.Reason;
         const btn=document.createElement("button");
         btn.className="btn btn-sm btn-danger"; btn.innerHTML="<i class='fas fa-trash'></i>";
         btn.onclick=()=>removeLeave(row.Date,row.Employee);
         li.appendChild(btn); list.appendChild(li);
       });
     }
     function addLeave(){
       const date=document.getElementById("leaveDate").value;
       const employee=document.getElementById("leaveEmployee").value;
       const type=document.getElementById("leaveType").value;
       const reason=document.getElementById("leaveReason").value;
       if(!date||!employee) return showToast("Date & Employee required","danger");
       fetchJSON(SCRIPT_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"addLeave",date,employee,type,reason})})
-        .then(()=>{showToast("Leave added","success");loadLeaves();});
+        .then(()=>{showToast("Leave added","success");loadLeaves();})
+        .catch(err=>{console.error(err);showToast("Failed to add leave","danger");});
     }
     function removeLeave(date,employee){
       fetchJSON(SCRIPT_URL,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"removeLeave",date,employee})})
-        .then(()=>{showToast("Leave removed","success");loadLeaves();});
+        .then(()=>{showToast("Leave removed","success");loadLeaves();})
+        .catch(err=>{console.error(err);showToast("Failed to remove leave","danger");});
     }
 
     // Init
     function loadAll(){ Promise.all([loadAttendance(),loadHolidays(),loadLeaves()]).then(()=>applyFilters()); }
     loadAll();
   </script>
 </body>
 </html>
